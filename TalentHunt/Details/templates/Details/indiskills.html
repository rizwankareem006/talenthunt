{% extends 'Details/base.html' %}
{% load static %}
{% block title %}Skills Details{% endblock %}
{% block header %}
<link rel="stylesheet" type="text/css" href="{% static 'Details/indiskills.css' %}">
<script type="text/javascript" src="{% static 'Details/indiskills.js' %}"></script>
<script>
    $(function(){
        $("#sub").click(function(){
            function getCookie(name) {
                var cookieValue = null;
                if (document.cookie && document.cookie != '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        var cookie = jQuery.trim(cookies[i]);
                        // Does this cookie string begin with the name we want?
                        if (cookie.substring(0, name.length + 1) == (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }
            var csrftoken = getCookie('csrftoken');
            function csrfSafeMethod(method) {
                // these HTTP methods do not require CSRF protection
                return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
            }
            $.ajaxSetup({
                beforeSend: function(xhr, settings) {
                    if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    }
                }
            });
            var len = $(".tokenValues").length;
            var arr = [];
            for(var i = 0; i < len; i++){
                arr.push($(".tokenValues").eq(i).text());
            }
            $("#skillset").val(arr);
            $.ajax({
                type:"POST",
                url:"{% url 'Details:IndividualSkills' %}",
                data:{
                    'skillset': arr,
                    'specialization': $("#specialization").val(),
                    'pastexp': $("#pastexp").val(),
                    'workexpec': $("#workexpec").val(),
                    'bio': $("#bio").val(),
                },
                success: function(response){
                    alert(response.status)
                    if (response.status == 0){
                        window.location = "{% url 'Details:Feed' page=1 %}";
                    }
                },
                dataType: 'json'
            });
        });
    });
</script>
{% endblock %}
{% block content %}
<form action="{% url 'Details:Logout' %}" method = "POST">
    {% csrf_token %}
    <button type="submit">Sign Out</button>
</form>
<h2>Welcome {{request.user}},</h2>
<form>
    {% csrf_token %}
    <div class="input-group">
        <input type="text" id="chipValue" class="form-control" placeholder="Add">
        <div class="input-group-btn">
            <button type="button" class="btn btn-outline-primary" id="addToken">
                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-plus" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M8 3.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H4a.5.5 0 0 1 0-1h3.5V4a.5.5 0 0 1 .5-.5z"/>
                    <path fill-rule="evenodd" d="M7.5 8a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0V8z"/>
                </svg>
            </button>
        </div>
    </div>
    <div id="tokens">
    </div>
    <label for="specialization">Specialization</label>
    <textarea id="specialization" name="specialization"></textarea>
    <label for="pastexp">Past Experiences</label>
    <textarea id="pastexp" name="pastexp"></textarea>
    <label for="workexpec">Work Expectations</label>
    <textarea id="workexpec" name="workexpec"></textarea>
    <label for="bio">Bio</label>
    <textarea id="bio" name="bio"></textarea>
    <button type="button" id="sub">Submit</button>
</form>
{% endblock %}